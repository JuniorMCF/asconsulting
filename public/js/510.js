"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[510],{6510:(t,e,a)=>{a.r(e),a.d(e,{default:()=>i});const o={name:"change-role-dialog",data:function(){return{dialog:!1,resolve:null,reject:null,load:!1,user:{name:""},role:null,roles:[],options:{color:"sky",width:400,zIndex:200,noconfirm:!1}}},methods:{getRoles:function(){var t=this;axios({method:"get",url:"/api/oauth/roles",headers:{Authorization:"Bearer "+this.$store.state.auth.token}}).then((function(e){t.roles=e.data,t.dialog=!0})).catch((function(e){console.log(e.response),t.dialog=!1}))},changeRole:function(){var t=this;this.load=!0;var e=new FormData;e.append("rol_id",this.role.id),e.append("user_id",this.user.id),axios({method:"post",url:"/api/oauth/rol/update",headers:{Authorization:"Bearer "+this.$store.state.auth.token},data:e}).then((function(e){t.load=!1,t.resolve(!0),t.dialog=!1})).catch((function(e){console.log(e.response),t.dialog=!1,t.load=!1}))},open:function(t,e,a){var o=this;return this.user=t,this.role=e,console.log(e),this.getRoles(),this.options=Object.assign(this.options,a),new Promise((function(t,e){o.resolve=t,o.reject=e}))},agree:function(){this.resolve(!0),this.dialog=!1},cancel:function(){this.resolve(!1),this.dialog=!1}}};var n=a(1900);const s={name:"escritores-component",components:{ChangeRoleDialog:(0,n.Z)(o,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{style:{zIndex:t.options.zIndex},attrs:{opacity:"0.3","max-width":t.options.width,persistent:""},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.cancel.apply(null,arguments)}},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-card",[a("v-toolbar",{attrs:{color:t.options.color,dense:"",flat:""}},[a("v-toolbar-title",{staticClass:"text-body-2 font-weight-bold white--text"},[t._v("\n                Cambiar rol de usuario\n            ")])],1),t._v(" "),a("v-card-text",[a("p",{staticClass:"pt-4 text-center text-body-2  black--text font-weight-bold"},[t._v("\n                "+t._s(t.user.name+" "+t.user.last_name)+"\n            ")]),t._v(" "),a("v-select",{attrs:{items:t.roles,label:"Rol de usuario",variant:"outlined",name:"name","item-text":"name","return-object":""},model:{value:t.role,callback:function(e){t.role=e},expression:"role"}})],1),t._v(" "),a("v-card-actions",{staticClass:"pt-3"},[a("v-spacer"),t._v(" "),a("v-btn",{staticClass:"body-2 font-weight-bold text-normal rounded-0",attrs:{color:t.options.color,outlined:"",loading:t.load},nativeOn:{click:function(e){return t.changeRole()}}},[t._v("Guardar cambios")]),t._v(" "),t.options.noconfirm?t._e():a("v-btn",{staticClass:"body-2 font-weight-bold text-normal rounded-0",attrs:{color:"grey",text:""},nativeOn:{click:function(e){return t.cancel.apply(null,arguments)}}},[t._v("Cancelar")])],1)],1)],1)}),[],!1,null,null,null).exports},data:function(){return{headers:[{text:"",align:"left",sortable:!1,value:"foto"},{text:"Nombres",align:"left",sortable:!1,value:"nombre"},{text:"Rol",value:"roles"},{text:"Contador de entrada",value:"entradas"},{text:" ",align:"right",value:"actions",sortable:!1}],users:[],search:null,options:[{icon:"mdi-restore",title:"Cambiar rol"},{icon:"mdi-pencil",title:"Editar"},{icon:"mdi-trash-can",title:"Eliminar"}]}},mounted:function(){this.setActualPage(),this.getData()},methods:{setActualPage:function(){this.$store.dispatch("app/saveActualPage","Escritores")},getData:function(){var t=this;axios({method:"get",url:"/api/oauth/writers",headers:{Authorization:"Bearer "+this.$store.state.auth.token}}).then((function(e){t.users=e.data})).catch((function(t){console.log(t.response)}))},OnClickOption:function(t,e){var a=this;if("Cambiar rol"===t.title)this.$refs.changeRoleDialog.open(e,e.roles[0]).then((function(t){t&&a.getData()})).catch((function(t){}))}},computed:{actualPage:function(){return this.$store.state.app.actual_page}}};const i=(0,n.Z)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-card-title",{staticClass:"font-weight-bold px-md-10 px-3"},[t._v(t._s(t.actualPage))]),t._v(" "),a("v-container",{staticClass:"pa-0 ma-0 px-md-10 px-3",attrs:{fluid:""}},[a("v-row",{staticClass:"pa-0 ma-0"},[a("v-col",{staticClass:"pa-0 ma-0 col-12"},[a("v-card-text",{staticClass:"px-0 py-0"},[a("p",{staticClass:"caption ma-0"},[t._v("Administra a los escritores de tu blog, crea y personaliza sus perfiles\n                        públicos. Todos aquí tienen permiso para escribir entradas.")])])],1)],1)],1),t._v(" "),a("v-container",{staticClass:"pa-0 ma-0 px-md-10 px-3",attrs:{fluid:""}},[a("v-row",{staticClass:"pa-0 ma-0"},[a("v-col",{staticClass:"col-12 pa-0 ma-0"},[a("v-data-table",{staticClass:"elevation-0 px-0 rounded-0",attrs:{headers:t.headers,items:t.users,search:t.search,"sort-by":"calories","hide-default-footer":"","disable-pagination":""},scopedSlots:t._u([{key:"item.foto",fn:function(e){var o=e.item;return[a("div",{staticClass:"pa-2"},[o.foto?a("v-img",{staticClass:"mx-auto",attrs:{src:o.foto,height:"60",width:"42"}}):a("div",{staticClass:"gray lighten-5 rounded-lg align-center justify-center d-flex mx-auto",staticStyle:{width:"60px",height:"60px"}},[a("v-btn",{staticClass:"elevation-0 disable-events",attrs:{fab:"",color:"white","x-small":""}},[a("v-icon",{attrs:{color:"sky"}},[t._v("mdi-image-outline")])],1)],1)],1)]}},{key:"item.roles",fn:function(e){var o=e.item;return[a("span",[t._v(t._s(o.roles[0].name))])]}},{key:"item.entradas",fn:function(e){var o=e.item;return[a("span",[t._v(t._s(o.entradas.length))])]}},{key:"item.nombre",fn:function(e){var o=e.item;return[a("span",[t._v(t._s(o.name+" "+o.last_name))])]}},{key:"item.actions",fn:function(e){var o=e.item;return[a("v-menu",{attrs:{bottom:"",left:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,s=e.attrs;return["propietario"!=o.roles[0].slug?a("v-btn",t._g(t._b({staticClass:"elevation-0 sky--text",attrs:{dark:"",icon:"",text:"",fab:"","x-small":""}},"v-btn",s,!1),n),[a("v-icon",[t._v("mdi-dots-vertical")])],1):t._e()]}}],null,!0)},[t._v(" "),a("v-list",t._l(t.options,(function(e,n){return a("v-list-item",{key:"options"+n,attrs:{link:""},on:{click:function(a){return a.preventDefault(),t.OnClickOption(e,o)}}},[a("v-list-item-title",{staticClass:"caption"},[a("v-icon",{attrs:{small:"",left:""}},[t._v(t._s(e.icon))]),t._v("\n                                        "+t._s(e.title)+"\n                                    ")],1),t._v(" "),3===n?a("v-divider",{attrs:{horizontal:""}}):t._e()],1)})),1)],1)]}},{key:"no-data",fn:function(){return[a("span",[t._v("No hay publicaciones disponibles")])]},proxy:!0}])})],1)],1)],1),t._v(" "),a("ChangeRoleDialog",{ref:"changeRoleDialog"})],1)}),[],!1,null,null,null).exports}}]);